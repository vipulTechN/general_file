/////////////////html form 2 //////////////
<section>
    <div class="col-md-4 careerform1" style="display: block;">
      <div class="brand-logo" style="display: flow;"><img src="https://static.searchhomesindia.com/images/shi_logo_small.png" alt="shi_logo_small"></div>
        <div class="crossbtns" onclick="closeForm()">x</div>
        <form id="PropContactform2">
          
          <input type="hidden" name="project" id="Propdetail2" value="Prestige Kings County" style="border: none;">
            <input type="hidden" name="username" id="usercontact2" placeholder="Your name" tabindex="1" value="8147267372" required="">
          
            <div class="form-group">
                <label for="exampleInputName">Full Name</label>
                <input type="text" id="username2" name="name" class="form-control" placeholder="Enter your name" required="">
                <!-- Name valid or invalid checker div's -->
                <div class="valid-feedback" id="isnamevalid2" style="color: green; font-size: 10px; display: none;">
                  Looks good!
                </div>
                <div class="invalid-feedback" id="isnameinvalid2" style="color: red; font-size: 10px; display: none;">
                  Please Enter a valid Name.
                </div>
            </div>
            <div class="form-group">
                <label for="exampleInputEmail1">Email address</label>
                <input type="email" id="useremail2" name="email" class="form-control" aria-describedby="emailHelp" placeholder="Enter your email address" required="">
                <!-- Email valid or invalid checker div's -->
                <div class="valid-feedback" id="isemailvalid2" style="color: green; font-size: 10px; display: none;">
                  Looks good!
                </div>
                <div class="invalid-feedback" id="isemailinvalid2" style="color: red; font-size: 10px; display: none;">
                  Please Enter a valid Name.
                </div>
            </div>
            <div class="form-group">
                <label for="example-tel-input">Mobile No.</label>

                <span id="sendotpdivone">
                  <input type="tel" id="userphone2" name="mobile" class="form-control" placeholder="Enter Number*" required>
                  <button type="button" class="sendotp" onclick="sendOtpone()">Send OTP</button>
                </span>
                <span id="verifyotpdivone" style="display: none;">
                  <input type="text" id="otpinputone" name="otp" class="form-control" placeholder="Enter OTP*" required>
                  <button type="button" class="verifyotp" onclick="verifyOtpone()">Verify OTP</button>
                </span>

                <div id="otpResultone" style="font-size: 10px;"></div>
                <div id="phoneErrorone" style="color: red; font-size: 10px; display: none;"></div>
                <div id="otpErrorone" style="color: red; font-size: 10px; display: none;"></div>
                <div id="otpSuccessone" style="color: green; font-size: 10px; display: none;"></div>
                <!-- Phone valid or invalid checker div's -->
                <div class="valid-feedback" id="isphonevalid2" style="color: green; font-size: 10px; display: none;">
                  Looks good!
                </div>
                <div class="invalid-feedback" id="isphoneinvalid2" style="color: red; font-size: 10px; display: none;">
                  Please Enter a valid Name.
                </div>
            </div>
         
                <div class="form-group">
                  <label for="example-tel-input">Message</label>
                  <textarea placeholder="Message" class="form-control" id="usermessage2" rows="2" required="" style="height: auto;"></textarea>
                  <!-- Message valid or invalid checker div's -->
                  <div class="valid-feedback" id="ismessagevalid2" style="color: green; font-size: 10px; display: none;">
                    Looks good!
                  </div>
                  <div class="invalid-feedback" id="ismessageinvalid2" style="color: red; font-size: 10px; display: none;">
                    Please Enter a valid Name.
                  </div>
              </div>
              <div class="row" style="margin-right: 0;
                      margin-left: 0; padding-bottom: 5px;">
                <!-- Alert blocks to show the alerts regarding the submission of the form -->
                <!-- success alert block -->
                <div class="alert alert-success alert-dismissible" role="alert" id="issuccess2" style="margin-bottom: 0px; font-size: 10px; display: none;">
                  <strong>ThankYou for your response!</strong> Our team will get back to you soon.
                  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                <!-- failure alert block -->
                <div class="alert alert-danger alert-dismissible" role="alert" id="isfailure2" style="margin-bottom: 0px; font-size: 10px; display: none;">
                  <strong>Something went wrong!</strong> Please fill the details properly.
                  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
              </div>
            <button type="submit" class="careersub" id="contactsubmit2" name="btn_submit">Submit</button>
        </form>
    </div>
  </section>
//////////////////// form 2script/////////////////////////

const Name2 = document.getElementById("username2"),
    Email2 = document.getElementById("useremail2"),
    Phone2 = document.getElementById("userphone2"),
    Message2 = document.getElementById("usermessage2"),
    Propdetail2 = document.getElementById("Propdetail2"),
    usercontact2 = document.getElementById("usercontact2"),
    Form2 = document.getElementById("PropContactform2"),
    SubmitButton2 = document.getElementById("contactsubmit2"),
    csrftoken2 = document.querySelector("[name=csrfmiddlewaretoken]").value,
    Namevalid2 = document.getElementById("isnamevalid2"),
    Nameinvalid2 = document.getElementById("isnameinvalid2"),
    Emailvalid2 = document.getElementById("isemailvalid2"),
    Emailinvalid2 = document.getElementById("isemailinvalid2"),
    Phonevalid2 = document.getElementById("isphonevalid2"),
    Phoneinvalid2 = document.getElementById("isphoneinvalid2"),
    Messagevalid2 = document.getElementById("ismessagevalid2"),
    Messageinvalid2 = document.getElementById("ismessageinvalid2"),
    SuccessAlert2 = document.getElementById("issuccess2"),
    FailureAlert2 = document.getElementById("isfailure2");
    sendOtpDivone = document.getElementById("sendotpdivone"),
    verifyOtpDivone = document.getElementById("verifyotpdivone"),
    otpInputone = document.getElementById("otpinputone"),
    otpResultone = document.getElementById("otpResultone"),
    phoneErrorone = document.getElementById("phoneErrorone"),
    otpErrorone = document.getElementById("otpErrorone"),
    otpSuccessone = document.getElementById("otpSuccessone");

let validName2 = false,
    validEmail2 = false,
    validPhone2 = false,
    validMessage2 = false,
    otpSentone = false,
    otpVerifiedone = false,
    generatedOtpone = "";

    function generateOtpone() {
        return Math.floor(1000 + Math.random() * 9000).toString();
      }

      function sendOtpone() {
        // console.log("Sending OTP...");
        const userPhone = Phone2.value;
      
        if (userPhone === "") {
          Phone2.style.borderBottom = '2px solid red';
          phoneErrorone.innerText = 'Enter your phone number to send OTP';
          phoneErrorone.style.display = 'block';
        } else {
          generatedOtpone = generateOtpone();
          otpSentone = true;
      
          var xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
              var response = this.responseText;
              if (response.includes("success")) {
                otpResultone.style.color = 'green';
                otpResultone.innerText = 'OTP sent successfully!';
                sendOtpDivone.style.display = 'none';
                verifyOtpDivone.style.display = 'flex';
              } else {
                otpResultone.style.color = 'red';
                otpResultone.innerText = 'Failed to send OTP.';
                sendOtpDivone.style.display = 'flex';
                verifyOtpDivone.style.display = 'none';
              }
            } else {
              otpResultone.style.color = 'red';
              otpResultone.innerText = 'Failed to send OTP.';
              sendOtpDivone.style.display = 'flex';
              verifyOtpDivone.style.display = 'none';
            }
          };
      
          var url = "https://www.fast2sms.com/dev/bulkV2?authorization=E2SO3Qc7HLJc7foeIWZrM8CAGhMFVV07L5YU9ZpykVYCWQ4BhTEBocweBqy6&variables_values=" + generatedOtpone + "&route=otp&numbers=" + encodeURIComponent(userPhone);
          xhttp.open("GET", url, true);
          xhttp.send();
      
          phoneErrorone.style.display = 'none';
        }
      }
      
      function verifyOtpone() {
        // console.log("Verifying OTP...");
        const otpone = otpInputone.value;
      
        if (otpone === "") {
          otpInputone.style.borderBottom = '2px solid red';
          otpErrorone.innerText = 'Enter the OTP to verify';
          otpErrorone.style.display = 'block';
        } else if (otpone === generatedOtpone) {
          otpVerifiedone = true;
          otpErrorone.style.display = 'none';
          otpInputone.style.borderBottom = '';
          otpSuccessone.innerText = 'OTP verified successfully!';
          otpSuccessone.style.display = 'block';
          otpResultone.style.display = 'none';
          otpInputone.setAttribute('readonly', true);
        } else {
          otpInputone.style.borderBottom = '2px solid red';
          otpErrorone.innerText = 'Invalid OTP, please try again.';
          otpErrorone.style.display = 'block';
          otpSuccessone.style.display = 'none';
        }
      }

    function Refresh() {
        setTimeout(() => {
            location.reload();
        }, 3000);
    }

Name2.addEventListener("blur", () => {
    let e = Name2.value;
    /^[a-z\sA-z]{3,30}$/.test(e)
        ? ((Namevalid2.style.display = "block"),
            (Nameinvalid2.style.display = "none"),
            (validName2 = true))
        : ((Nameinvalid2.style.display = "block"),
            (Namevalid2.style.display = "none"));
}),
    Email2.addEventListener("blur", () => {
        let e = Email2.value;
        /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)$/.test(
            e
        )
            ? ((Emailvalid2.style.display = "block"),
                (Emailinvalid2.style.display = "none"),
                (validEmail2 = true))
            : ((Emailvalid2.style.display = "none"),
                (Emailinvalid2.style.display = "block"));
    }),
    Phone2.addEventListener("blur", () => {
        let e = Phone2.value;
        /^[0-9]{10}$/.test(e)
            ? ((Phonevalid2.style.display = "block"),
                (Phoneinvalid2.style.display = "none"),
                (validPhone2 = true))
            : ((Phonevalid2.style.display = "none"),
                (Phoneinvalid2.style.display = "block"));
    }),
    Message2.addEventListener("blur", () => {
        let e = Message2.value;
        /[a-zA-Z]/.test(e)
            ? ((Messagevalid2.style.display = "block"),
                (Messageinvalid2.style.display = "none"),
                (validMessage2 = true))
            : ((Messagevalid2.style.display = "none"),
                (Messageinvalid2.style.display = "block"));
    }),
    Form2.addEventListener("submit", (e) => {
      console.log("form is validated",validName3)
      console.log("form is validated",validPhone3)
      console.log("form is validated",otpSentone)
      console.log("form is validated",otpVerifiedone)
      e.preventDefault();
        if (validName2 && validEmail2 && otpSentone && otpVerifiedone) {
            fetch("/propertycontactdata/", {
                method: "POST",
                body: JSON.stringify({
                Name: Name2.value,
                Email: Email2.value,
                Phone: Phone2.value,
                Message: Message2.value,
                Propdetail: Propdetail2.value,
                User: usercontact2.value,
            }),
             headers: {
               "Content-Type": "application/json",
               "X-CSRFToken": csrftoken2,
             },
          })
          .then((response) => response.json())
          .then((data) => {
            if (data.success
            ) {
                Form2.reset();
                SuccessAlert2.style.display = "block";
                FailureAlert2.style.display = "none";
                Refresh();
            } else {
                Form2.reset();
                FailureAlert2.style.display = "block";
                SuccessAlert2.style.display = "none";
                // console.log("Form submission failed: ", data.error);
                // Refresh();
              }
            })
            .catch(() => {
                Form2.reset();
                FailureAlert2.style.display = "block";
                SuccessAlert2.style.display = "none";
                console.error("Form submission error: ", error);
                // Refresh();
              });
        }  else {
            FailureAlert2.style.display = "block";
            SuccessAlert2.style.display = "none";
          }
    });
